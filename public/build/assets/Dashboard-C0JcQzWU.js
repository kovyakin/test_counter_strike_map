import{_ as j}from"./AppLayout-DhBp9DVK.js";import{r,n as h,i as d,F as z,v as A,g as B,j as l,k as n,u as o,D as k,p as E,x as g,q as w,E as D,G as O,a as R,l as p,H as U,I as W}from"./primevue-MSFAoLlo.js";import{n as q,W as x}from"./app-CYs4EUiz.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css            */const H={class:"grid grid-cols-3 gap-2"},K=["src"],L={class:"m-0"},M={class:"flex gap-4 mt-1"},P={key:1},J={key:0,class:"text-green-500"},Q={__name:"Game",props:{cards:Array,start:Boolean,disabled:Boolean},emits:["ban","selected"],setup(N,{emit:m}){const s=N,e=r(s.cards),c=m,_=r(s.disabled),u=t=>{_.value=!_.value,e.value.length>1&&(e.value=e.value.filter(f=>f.id!==t),c("ban",t)),e.value.length===1&&c("selected",e.value[0].id)};return(t,f)=>(d(),h("div",H,[(d(!0),h(z,null,A(e.value,v=>(d(),B(o(D),{key:v.id,style:{width:"25rem",overflow:"hidden"}},{header:l(()=>[n("img",{alt:"user header",class:"",src:v.image},null,8,K)]),title:l(()=>[w(g(v.title),1)]),subtitle:l(()=>[w(g(v.subtitle),1)]),content:l(()=>[n("p",L,g(v.content),1)]),footer:l(()=>[n("div",M,[e.value.length>1&&s.start?(d(),B(o(k),{label:"Убрать",disabled:_.value,key:s.disabled,severity:"danger",class:"w-full",onClick:T=>u(v.id)},null,8,["disabled","onClick"])):(d(),h("div",P,[e.value.length===1?(d(),h("p",J,"Эта карта выбрана")):E("",!0)]))])]),_:2},1024))),128))]))}},X={class:"flex gap-2"},Y={class:"gap-2 my-2"},Z={class:"py-12"},ee={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},te={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-xl sm:rounded-lg"},le=["src"],se={class:"m-0"},ae={class:"flex justify-end gap-2"},de={__name:"Dashboard",setup(N){const{props:m}=q(),s=r(m.cards),e=r(m.disabled),c=r(!1);O(()=>{y(),t.value=!1});const _=r(),u=r(null),t=r(!1),f=r(!0),v=a=>{s.value.length>1?(u.value={image:null,title:"Ожидание ответа игрока",subtitle:"Игрок выбирает карту",content:"Подождите!"},f.value=!1,c.value=a):(f.value=!0,V())},T=()=>{x.get("/start/"+m.user,{},{preserveScroll:!0}),$.value+=1},F=()=>{t.value=!0,C()},G=()=>{x.get("/stop",{},{preserveScroll:!0})},C=()=>{y(),s.value.length>1&&(_.value=setInterval(()=>{b.value+=100/60,b.value>=100&&(y(),u.value={image:null,title:"Время выбора вышло!",subtitle:"Карта не была выбрана!",content:"Начните заново!"},f.value=!0,c.value=!0)},1e3))},y=()=>{b.value=0,clearInterval(_.value),_.value=null},I=a=>{a&&(x.post("/game",{id:a,user:m.user},{preserveScroll:!0}),b.value=0,C())},V=a=>{y(),c.value=!0,u.value=s.value[0]},b=r(0);R({cards:null});const $=r(0);return typeof window<"u"&&window.Echo&&Echo.channel("game").listen("BanCardEvent",a=>{!t.value&&a.cards==="START"?(a.user_id!==m.user&&(e.value=!0,v(e.value)),F()):t.value&&a.cards==="STOP"?(s.value=m.cards,e.value=!0,t.value=!1,c.value=!1,y(),$.value+=1):t.value&&isFinite(a.cards)&&(s.value=s.value.filter(i=>i.id!==a.cards),e.value=!e.value,v(e.value),C()),$.value+=1}),(a,i)=>(d(),h(z,null,[n("form",null,[p(j,{title:"Game"},{header:l(()=>[n("div",X,[i[3]||(i[3]=n("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"}," Выбор бана карт ",-1)),p(o(k),{label:"Start",disabled:t.value,size:"small",severity:"success",onClick:T},null,8,["disabled"]),p(o(k),{label:"Stop",disabled:!t.value,size:"small",severity:"danger",onClick:i[0]||(i[0]=S=>o(x).get("/stop"))},null,8,["disabled"]),p(o(k),{label:"Results",disabled:t.value,size:"small",severity:"info",onClick:i[1]||(i[1]=S=>o(x).get("/result"))},null,8,["disabled"])]),n("div",Y,[p(o(U),{value:b.value},{default:l(()=>[w(g(100-Math.round(b.value))+"%",1)]),_:1},8,["value"])])]),default:l(()=>[n("div",Z,[n("div",ee,[n("div",te,[(d(),B(Q,{cards:s.value,key:$.value,start:t.value,disabled:e.value,onSelected:V,onBan:I},null,8,["cards","start","disabled"]))])])])]),_:1})]),p(o(W),{visible:c.value,"onUpdate:visible":i[2]||(i[2]=S=>c.value=S),modal:"",closeOnEscape:!1,closable:!1,header:"Выбранная карта",style:{width:"50rem"}},{default:l(()=>[p(o(D),{style:{width:"50rem",overflow:"hidden"}},{header:l(()=>[u.value.image?(d(),h("img",{key:0,class:"",src:u.value.image,alt:"no_card"},null,8,le)):E("",!0)]),title:l(()=>[w(g(u.value.title),1)]),subtitle:l(()=>[w(g(u.value.subtitle),1)]),content:l(()=>[n("p",se,g(u.value.content),1)]),footer:l(()=>i[4]||(i[4]=[])),_:1}),n("div",ae,[f.value?(d(),B(o(k),{key:0,type:"button",label:"Закрыть",severity:"secondary",onClick:G})):E("",!0)])]),_:1},8,["visible"])],64))}};export{de as default};
